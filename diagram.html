<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgentGate Architecture</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Instrument+Serif:ital@0;1&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
  :root {
    --bg: #050505; --surface: #0c0c0c; --border: #1a1a1a;
    --text: #e8e8e8; --text-2: #737373; --text-3: #454545;
    --accent: #c8ff00; --accent-dim: #3d4d00;
  }
  body {
    background: var(--bg); color: var(--text);
    font-family: 'Outfit', sans-serif;
    padding: 48px 40px; min-height: 100vh;
    -webkit-font-smoothing: antialiased;
  }
  body::after {
    content: ''; position: fixed; inset: 0; z-index: 9999; pointer-events: none; opacity: 0.015;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  }
  code, .mono { font-family: 'DM Mono', monospace; }
  .serif { font-family: 'Instrument Serif', serif; }

  h1 { text-align: center; font-family: 'Outfit', sans-serif; font-size: 28px; font-weight: 400; letter-spacing: -0.03em; margin-bottom: 6px; color: var(--text); }
  h1 span { color: var(--accent); }
  .subtitle { text-align: center; color: var(--text-2); font-size: 14px; margin-bottom: 48px; font-family: 'DM Mono', monospace; font-size: 13px; }

  .diagram { max-width: 1100px; margin: 0 auto; }

  .section-label {
    font-family: 'DM Mono', monospace; font-size: 11px; color: var(--accent);
    letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 16px;
  }

  /* Main flow box */
  .main-flow {
    background: var(--surface); border: 1px solid var(--border); border-radius: 8px;
    padding: 28px 32px; margin-bottom: 32px;
  }
  .main-flow h2 {
    font-size: 16px; font-weight: 500; margin-bottom: 24px; color: var(--text);
    letter-spacing: -0.02em;
  }

  .step-row { display: flex; align-items: stretch; gap: 0; }
  .step {
    flex: 1; padding: 14px 16px; position: relative;
    border-left: 1px solid var(--border); padding-left: 20px;
  }
  .step:first-child { border-left: none; padding-left: 0; }
  .step-num {
    display: inline-flex; align-items: center; justify-content: center;
    width: 26px; height: 26px; border-radius: 50%;
    font-size: 12px; font-weight: 600; margin-bottom: 8px;
    font-family: 'DM Mono', monospace;
  }
  .step-num.n1 { background: var(--accent); color: #000; }
  .step-num.n2 { background: #ff6b35; color: #000; }
  .step-num.n3 { background: #00d4aa; color: #000; }
  .step-num.n4 { background: #5b8def; color: #000; }
  .step-num.n5 { background: #c084fc; color: #000; }

  .step h4 { font-size: 13px; font-weight: 500; margin-bottom: 6px; letter-spacing: -0.01em; }
  .step p { font-size: 11px; color: var(--text-2); line-height: 1.6; }
  .step code {
    background: var(--bg); border: 1px solid var(--border);
    padding: 1px 6px; border-radius: 3px; font-size: 10px; color: var(--accent);
  }

  /* Actor columns */
  .actors { display: flex; gap: 16px; margin-bottom: 32px; }
  .actor-col {
    flex: 1; background: var(--surface); border: 1px solid var(--border);
    border-radius: 8px; padding: 20px;
    transition: border-color 0.3s;
  }
  .actor-col:hover { border-color: var(--accent-dim); }
  .actor-col.highlight { border-color: var(--accent-dim); }
  .actor-col h3 { font-size: 14px; font-weight: 500; margin-bottom: 4px; }
  .actor-col .actor-sub { font-size: 11px; color: var(--text-3); margin-bottom: 14px; font-family: 'DM Mono', monospace; }
  .actor-col ul { list-style: none; }
  .actor-col li {
    font-size: 12px; color: var(--text-2); padding: 5px 0;
    border-bottom: 1px solid var(--border);
  }
  .actor-col li:last-child { border-bottom: none; }
  .emoji { margin-right: 6px; }

  /* Tempo features */
  .tempo-features { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 32px; }
  .tempo-feat {
    background: var(--surface); border: 1px solid var(--accent-dim);
    border-radius: 8px; padding: 16px; text-align: center;
  }
  .tempo-feat .feat-icon { font-size: 22px; margin-bottom: 8px; }
  .tempo-feat h4 { font-size: 12px; color: var(--accent); margin-bottom: 4px; font-family: 'DM Mono', monospace; }
  .tempo-feat p { font-size: 10px; color: var(--text-3); line-height: 1.5; }

  /* Components grid */
  .components { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 32px; }
  .component {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 8px; padding: 20px;
    transition: border-color 0.3s;
  }
  .component:hover { border-color: var(--accent-dim); }
  .component h3 { font-size: 14px; font-weight: 500; margin-bottom: 10px; }
  .component ul { list-style: none; }
  .component li { font-size: 12px; color: var(--text-2); padding: 3px 0; }
  .component li::before { content: '‚Üí '; color: var(--text-3); }
  .component .tech {
    display: inline-block; background: var(--bg); border: 1px solid var(--border);
    padding: 2px 8px; border-radius: 4px; font-size: 10px; color: var(--accent);
    margin-top: 10px; font-family: 'DM Mono', monospace;
  }

  /* Data model */
  .data-model h4 { font-size: 13px; color: var(--accent); margin-bottom: 8px; font-family: 'DM Mono', monospace; }
  .data-model code {
    display: block; font-size: 11px; line-height: 1.8; color: var(--text-2);
    background: none; border: none; padding: 0;
  }
</style>
</head>
<body>

<h1>‚ö° AgentGate</h1>
<p class="subtitle">AI Agent Payment Gateway on Tempo ‚Äî Pay for any service with a single HTTP request</p>

<div class="diagram">

  <div class="main-flow">
    <h2>üîÑ Payment Flow (x402-style)</h2>
    <div class="step-row">
      <div class="step">
        <div class="step-num n1">1</div>
        <h4>Agent ‚Üí Gateway</h4>
        <p>AI agent sends HTTP request to a service endpoint.<br><code>POST /api/inference</code><br>No payment attached yet.</p>
      </div>
      <div class="step">
        <div class="step-num n2">2</div>
        <h4>Gateway ‚Üí 402</h4>
        <p>Gateway checks: no payment found.<br>Returns <code>HTTP 402 Payment Required</code><br>with price, wallet address, token (pathUSD), and memo format.</p>
      </div>
      <div class="step">
        <div class="step-num n3">3</div>
        <h4>Agent Pays on Tempo</h4>
        <p>Agent's Privy server wallet sends a <strong>TIP-20 transfer</strong> on Tempo.<br>Amount: $0.01 pathUSD<br>Memo: request hash for reconciliation.<br><em>Sub-second finality.</em></p>
      </div>
      <div class="step">
        <div class="step-num n4">4</div>
        <h4>Agent Retries + Proof</h4>
        <p>Agent re-sends the HTTP request with<br><code>X-Payment-Tx: 0xabc...</code> header.<br>Gateway verifies tx on Tempo (instant).<br>‚úÖ Confirmed ‚Üí proxies to real service.</p>
      </div>
      <div class="step">
        <div class="step-num n5">5</div>
        <h4>Service ‚Üí Agent</h4>
        <p>Real service processes the request.<br>Response flows back through gateway to agent.<br>Payment receipt in <code>X-Payment-Receipt</code> header.</p>
      </div>
    </div>
  </div>

  <div class="actors">
    <div class="actor-col">
      <h3>ü§ñ AI Agents (Buyers)</h3>
      <div class="actor-sub">Consume services, pay per call</div>
      <ul>
        <li><span class="emoji">üîë</span> Privy server wallet (no seed phrases)</li>
        <li><span class="emoji">üí∞</span> Funded with pathUSD from faucet/deposit</li>
        <li><span class="emoji">üì¶</span> Uses AgentGate SDK for auto-pay</li>
        <li><span class="emoji">üîÅ</span> Handles 402 ‚Üí pay ‚Üí retry automatically</li>
        <li><span class="emoji">üìù</span> Transfer memos for tracking</li>
      </ul>
    </div>
    <div class="actor-col highlight">
      <h3>‚ö° AgentGate (Platform)</h3>
      <div class="actor-sub">Payment gateway + service registry</div>
      <ul>
        <li><span class="emoji">üõ°Ô∏è</span> Hono payment middleware</li>
        <li><span class="emoji">üìã</span> Service registry (endpoints + pricing)</li>
        <li><span class="emoji">‚úÖ</span> Tx verification via Tempo RPC</li>
        <li><span class="emoji">üîÄ</span> Request proxy to real services</li>
        <li><span class="emoji">üìä</span> Analytics dashboard for providers</li>
      </ul>
    </div>
    <div class="actor-col">
      <h3>üè™ Service Providers (Sellers)</h3>
      <div class="actor-sub">Register endpoints, earn stablecoins</div>
      <ul>
        <li><span class="emoji">üìù</span> Register via dashboard or API</li>
        <li><span class="emoji">üí≤</span> Set per-call pricing in pathUSD</li>
        <li><span class="emoji">üåê</span> Any HTTP endpoint (AWS, Vercel, etc.)</li>
        <li><span class="emoji">üí∏</span> Instant settlement on every call</li>
        <li><span class="emoji">üìà</span> View earnings + call analytics</li>
      </ul>
    </div>
  </div>

  <p class="section-label">Tempo Features We Leverage</p>
  <div class="tempo-features">
    <div class="tempo-feat">
      <div class="feat-icon">‚ö°</div>
      <h4>Instant Finality</h4>
      <p>Sub-second tx confirmation = verify payment in the same HTTP round-trip</p>
    </div>
    <div class="tempo-feat">
      <div class="feat-icon">üíµ</div>
      <h4>No Native Token</h4>
      <p>Fees paid in pathUSD stablecoin ‚Äî agents only need one token</p>
    </div>
    <div class="tempo-feat">
      <div class="feat-icon">üìù</div>
      <h4>Transfer Memos</h4>
      <p>32-byte memo per transfer = embed request hash for reconciliation</p>
    </div>
    <div class="tempo-feat">
      <div class="feat-icon">üéÅ</div>
      <h4>Fee Sponsorship</h4>
      <p>Platform sponsors gas for agents ‚Äî zero friction onboarding</p>
    </div>
  </div>

  <p class="section-label">System Components</p>
  <div class="components">
    <div class="component">
      <h3>üîß Core Package</h3>
      <ul>
        <li>Payment types & interfaces</li>
        <li>TIP-20 transfer verification</li>
        <li>Memo encoding/decoding</li>
        <li>Price calculation utils</li>
      </ul>
      <span class="tech">packages/core</span>
    </div>
    <div class="component">
      <h3>üõ°Ô∏è Hono Middleware</h3>
      <ul>
        <li>402 response generation</li>
        <li>Payment header parsing</li>
        <li>Tx verification on Tempo</li>
        <li>Request proxying</li>
      </ul>
      <span class="tech">packages/middleware</span>
    </div>
    <div class="component">
      <h3>ü§ñ Agent SDK</h3>
      <ul>
        <li>Auto 402 ‚Üí pay ‚Üí retry</li>
        <li>Privy wallet integration</li>
        <li>Balance management</li>
        <li>Transaction history</li>
      </ul>
      <span class="tech">packages/sdk</span>
    </div>
    <div class="component">
      <h3>‚ö° Gateway Server</h3>
      <ul>
        <li>Service registry CRUD</li>
        <li>Payment gateway routing</li>
        <li>Provider auth (Privy)</li>
        <li>Usage analytics</li>
      </ul>
      <span class="tech">apps/gateway ‚Äî Bun + Hono</span>
    </div>
    <div class="component">
      <h3>üé® Dashboard</h3>
      <ul>
        <li>Provider service management</li>
        <li>Earnings & tx history</li>
        <li>Agent wallet funding</li>
        <li>API key management</li>
      </ul>
      <span class="tech">apps/dashboard ‚Äî Next.js</span>
    </div>
    <div class="component">
      <h3>‚òÅÔ∏è Demo Services (AWS)</h3>
      <ul>
        <li>LLM Inference proxy ($0.01/call)</li>
        <li>Weather API ($0.001/call)</li>
        <li>Static site deployer ($1.00)</li>
        <li>Image generation ($0.05)</li>
      </ul>
      <span class="tech">apps/demo-services ‚Äî AWS Lambda</span>
    </div>
  </div>

  <div class="main-flow data-model">
    <h2>üóÑÔ∏è Data Model</h2>
    <div class="step-row" style="gap: 24px; flex-wrap: wrap;">
      <div style="flex: 1; min-width: 200px;">
        <h4>Services</h4>
        <code>
          id: string<br>
          provider_wallet: address<br>
          name: string<br>
          endpoint_url: string<br>
          price_per_call: string (USD)<br>
          token: address (pathUSD)<br>
          category: enum<br>
          total_calls: number<br>
          total_earned: string
        </code>
      </div>
      <div style="flex: 1; min-width: 200px;">
        <h4>Payments</h4>
        <code>
          tx_hash: string<br>
          service_id: string<br>
          agent_wallet: address<br>
          provider_wallet: address<br>
          amount: string<br>
          memo: bytes32<br>
          status: verified|failed<br>
          created_at: timestamp
        </code>
      </div>
      <div style="flex: 1; min-width: 200px;">
        <h4>Agents</h4>
        <code>
          id: string (Privy user)<br>
          wallet_id: string<br>
          wallet_address: address<br>
          balance_cached: string<br>
          total_spent: string<br>
          total_calls: number<br>
          created_at: timestamp
        </code>
      </div>
    </div>
  </div>

</div>
</body>
</html>
